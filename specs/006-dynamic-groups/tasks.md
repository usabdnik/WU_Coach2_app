# Feature 006: Tasks - Динамическая система групп

**Дата**: 2025-11-15
**Статус**: ✅ ВСЕ ЗАДАЧИ ЗАВЕРШЕНЫ
**Коммит**: `d409f90`

---

## Задачи

### T001: Анализ текущей реализации групп ✅
**Статус**: ЗАВЕРШЕНО
**Время**: ~10 мин

**Действия**:
- [x] Найти все места с хардкодом групп в index.html
- [x] Определить количество точек изменения
- [x] Оценить сложность рефакторинга

**Результат**: Найдено 3 места: HTML кнопки (982-985), HTML select (1037-1040), JS default (2625)

---

### T002: Создать массив AVAILABLE_GROUPS ✅
**Статус**: ЗАВЕРШЕНО
**Время**: ~5 мин
**Строка**: 1288

**Действия**:
- [x] Добавить глобальную константу после других переменных
- [x] Внести новые группы: М-19, М-117, М-118, А-29, А-218, А-219
- [x] Добавить комментарий для документации

**Код**:
```javascript
const AVAILABLE_GROUPS = ['М-19', 'М-117', 'М-118', 'А-29', 'А-218', 'А-219'];
```

---

### T003: Удалить хардкод HTML кнопок фильтра ✅
**Статус**: ЗАВЕРШЕНО
**Время**: ~5 мин
**Строки**: 981-985

**Действия**:
- [x] Удалить 4 кнопки с data-group
- [x] Оставить контейнер div с id для динамической генерации
- [x] Добавить комментарий-placeholder

**Было**:
```html
<button class="chip active" data-group="all">Все группы</button>
<button class="chip" data-group="Начинающие">Начинающие</button>
<button class="chip" data-group="Средняя">Средняя</button>
<button class="chip" data-group="Продвинутая">Продвинутая</button>
<button class="chip" data-group="Элитная">Элитная</button>
```

**Стало**:
```html
<!-- Group filter buttons will be generated dynamically from AVAILABLE_GROUPS -->
```

---

### T004: Удалить хардкод HTML опций select ✅
**Статус**: ЗАВЕРШЕНО
**Время**: ~5 мин
**Строки**: 1036-1041

**Действия**:
- [x] Удалить 4 option элемента
- [x] Оставить пустой select элемент
- [x] Добавить комментарий-placeholder

**Было**:
```html
<option value="Начинающие">Начинающие</option>
<option value="Средняя">Средняя</option>
<option value="Продвинутая">Продвинутая</option>
<option value="Элитная">Элитная</option>
```

**Стало**:
```html
<!-- Options will be populated dynamically from AVAILABLE_GROUPS -->
```

---

### T005: Создать функцию renderGroupFilters() ✅
**Статус**: ЗАВЕРШЕНО
**Время**: ~15 мин
**Строка**: 3360

**Действия**:
- [x] Создать функцию для динамической генерации кнопок
- [x] Добавить кнопку "Все группы" с active классом
- [x] Итерировать по AVAILABLE_GROUPS для создания остальных кнопок
- [x] Добавить event listeners для каждой кнопки
- [x] Вставлять кнопки перед кнопкой подписок (сохранить порядок)
- [x] Добавить console.log для отладки

**Код**: См. index.html:3360-3395

---

### T006: Создать функцию renderGroupOptions() ✅
**Статус**: ЗАВЕРШЕНО
**Время**: ~10 мин
**Строка**: 3345

**Действия**:
- [x] Создать функцию для заполнения select опциями
- [x] Очистить существующие опции
- [x] Итерировать по AVAILABLE_GROUPS
- [x] Создавать option элементы программно
- [x] Добавить console.log для отладки

**Код**: См. index.html:3345-3357

---

### T007: Добавить вызовы функций в DOMContentLoaded ✅
**Статус**: ЗАВЕРШЕНО
**Время**: ~5 мин
**Строки**: 1850-1851

**Действия**:
- [x] Найти DOMContentLoaded обработчик
- [x] Добавить renderGroupFilters() перед renderAthletes()
- [x] Добавить renderGroupOptions() после renderGroupFilters()
- [x] Проверить правильный порядок инициализации

**Код**:
```javascript
renderGroupFilters(); // Generate group filter buttons dynamically
renderGroupOptions(); // Generate group options in edit form
```

---

### T008: Удалить старые event listeners для chip кнопок ✅
**Статус**: ЗАВЕРШЕНО
**Время**: ~5 мин
**Строки**: 3389-3402 (старые)

**Действия**:
- [x] Удалить querySelectorAll('.chip') с addEventListener
- [x] Удалить инициализацию "All groups" как active
- [x] Добавить комментарий о новом месте обработчиков

**Причина**: Обработчики теперь встроены в renderGroupFilters()

---

### T009: Обновить дефолтное значение группы ✅
**Статус**: ЗАВЕРШЕНО
**Время**: ~5 мин
**Строка**: 2625

**Действия**:
- [x] Найти место преобразования данных из Supabase
- [x] Заменить 'Начинающие' на AVAILABLE_GROUPS[0]
- [x] Теперь дефолт = М-19 (первый элемент массива)

**Было**:
```javascript
group: athlete.group_name || 'Начинающие',
```

**Стало**:
```javascript
group: athlete.group_name || AVAILABLE_GROUPS[0],
```

---

### T010: Проверить отсутствие старых групп в коде ✅
**Статус**: ЗАВЕРШЕНО
**Время**: ~5 мин

**Действия**:
- [x] Grep по "Начинающие|Средняя|Продвинутая|Элитная"
- [x] Убедиться что результат пустой
- [x] Верифицировать использование AVAILABLE_GROUPS

**Результат**: 0 упоминаний старых групп, 8 упоминаний AVAILABLE_GROUPS

---

### T011: Удалить временные файлы ✅
**Статус**: ЗАВЕРШЕНО
**Время**: ~2 мин

**Действия**:
- [x] Найти папку "test android/" с временными скриншотами
- [x] Спросить разрешение на удаление
- [x] Удалить после подтверждения

**Результат**: Папка удалена, workspace чистый

---

### T012: Создать коммит с детальным описанием ✅
**Статус**: ЗАВЕРШЕНО
**Время**: ~5 мин
**Коммит**: d409f90

**Действия**:
- [x] git add index.html
- [x] git commit с HEREDOC сообщением
- [x] Описать все изменения
- [x] Указать технические детали (строки кода)
- [x] Добавить Co-Authored-By для Claude

---

### T013: Push на GitHub ✅
**Статус**: ЗАВЕРШЕНО
**Время**: ~2 мин

**Действия**:
- [x] git push origin main
- [x] Подтвердить успешный push
- [x] Проверить историю коммитов

**Результат**: cf0c226..d409f90 main -> main

---

### T014: Сохранить память о feature ✅
**Статус**: ЗАВЕРШЕНО
**Время**: ~10 мин

**Действия**:
- [x] Создать memory FEATURE_006_dynamic_groups
- [x] Описать техническую реализацию
- [x] Документировать все изменения
- [x] Добавить инструкции для будущих изменений групп

---

### T015: Создать spec.md для Feature 006 ✅
**Статус**: ЗАВЕРШЕНО
**Время**: ~15 мин

**Действия**:
- [x] Создать директорию specs/006-dynamic-groups/
- [x] Написать полную спецификацию
- [x] Включить требования, решение, тестирование
- [x] Документировать риски и будущие улучшения

---

### T016: Создать tasks.md для Feature 006 ✅
**Статус**: ЗАВЕРШЕНО
**Время**: ~10 мин

**Действия**:
- [x] Документировать все выполненные задачи
- [x] Указать время, строки кода, результаты
- [x] Создать чеклист для будущих изменений

---

## Общая статистика

**Всего задач**: 16
**Завершено**: 16 (100%)
**Время выполнения**: ~2 часа (включая анализ и документацию)

**Изменения в коде**:
- Файл: index.html
- Добавлено: 60 строк
- Удалено: 22 строки
- Net: +38 строк

**Git**:
- Коммит: d409f90
- Branch: main
- Remote: github.com/usabdnik/WU_Coach2_app

---

## Чеклист для изменения групп в будущем

Когда нужно изменить состав групп:

- [ ] Открыть index.html:1288
- [ ] Изменить массив AVAILABLE_GROUPS
- [ ] Сохранить файл
- [ ] Проверить в браузере (F12 → Console → логи)
- [ ] git add index.html
- [ ] git commit -m "Update: Изменение списка групп"
- [ ] git push origin main
- [ ] Обновить sw.js CACHE_NAME (если нужно принудительное обновление)
- [ ] Уведомить пользователей об очистке кэша

**Пример**:
```javascript
// Добавить новую группу
const AVAILABLE_GROUPS = ['М-19', 'М-117', 'М-118', 'А-29', 'А-218', 'А-219', 'Б-300'];

// Удалить группу
const AVAILABLE_GROUPS = ['М-19', 'М-117', 'М-118', 'А-29', 'А-218']; // без А-219

// Переименовать группу
const AVAILABLE_GROUPS = ['М-19', 'М-117', 'М-118', 'А-29', 'А-218', 'А-220']; // А-219 → А-220
```

---

## Следующие шаги

**Задача 2**: Исправить проблему "не все ученики отображаются"

**Ожидается информация от пользователя**:
- Какие фильтры активны?
- Сколько учеников должно быть?
- Сколько отображается сейчас?
