# CRM Import Script - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–∑ Google Sheets –≤ Supabase

–°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ (–§–ò–û, –≥—Ä—É–ø–ø–∞, —Å—Ç–∞—Ç—É—Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏) –∏–∑ Google Sheets CRM –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö Supabase.

---

## üìã –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç

1. **–ß–∏—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ Google Sheets** (–§–ò–û –∫–ª–∏–µ–Ω—Ç–æ–≤, –≥—Ä—É–ø–ø—ã, –¥–∞—Ç—ã –æ–∫–æ–Ω—á–∞–Ω–∏—è –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤)
2. **–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏** (–∞–∫—Ç–∏–≤–µ–Ω/–Ω–µ–∞–∫—Ç–∏–≤–µ–Ω) –ø–æ –Ω–∞–ª–∏—á–∏—é –¥–µ–π—Å—Ç–≤—É—é—â–µ–≥–æ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞
3. **–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ Supabase** —á–µ—Ä–µ–∑ Postgres —Ñ—É–Ω–∫—Ü–∏—é `save_athlete_with_validation()`
4. **–õ–æ–≥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** (—É—Å–ø–µ—à–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã, –æ—à–∏–±–∫–∏)

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd migration
npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`:

```bash
cp .env.example .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

```env
SUPABASE_URL=https://mjkssesvhowmncyctmvs.supabase.co
SUPABASE_SERVICE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
GOOGLE_SHEETS_ID=1ABC...xyz
GOOGLE_SERVICE_ACCOUNT_EMAIL=your-service@project.iam.gserviceaccount.com
GOOGLE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"
```

### 3. –ó–∞–ø—É—Å–∫ –∏–º–ø–æ—Ä—Ç–∞

```bash
npm run import
```

–ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é:

```bash
node import-from-crm.js
```

---

## ‚öôÔ∏è –î–µ—Ç–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –®–∞–≥ 1: Supabase Service Role Key

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Supabase Dashboard](https://app.supabase.com)
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `Settings` ‚Üí `API`
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **service_role** key (–ù–ï anon key!)

‚ö†Ô∏è **–í–ê–ñ–ù–û**: Service role key –∏–º–µ–µ—Ç –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –ë–î, —Ö—Ä–∞–Ω–∏—Ç–µ –µ–≥–æ –≤ —Å–µ–∫—Ä–µ—Ç–µ!

### –®–∞–≥ 2: Google Sheets ID

–û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à—É —Ç–∞–±–ª–∏—Ü—É Google Sheets —Å –¥–∞–Ω–Ω—ã–º–∏ CRM.

URL –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:
```
https://docs.google.com/spreadsheets/d/{GOOGLE_SHEETS_ID}/edit
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID –∏–∑ URL.

### –®–∞–≥ 3: Google Service Account

#### 3.1 –°–æ–∑–¥–∞–Ω–∏–µ Service Account

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Google Cloud Console](https://console.cloud.google.com)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `IAM & Admin` ‚Üí `Service Accounts`
3. –ù–∞–∂–º–∏—Ç–µ `+ CREATE SERVICE ACCOUNT`
4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   - Name: `wu-coach-crm-import`
   - Description: `Service account for CRM data import`
5. –ù–∞–∂–º–∏—Ç–µ `CREATE AND CONTINUE`
6. **–†–æ–ª—å –Ω–µ –Ω—É–∂–Ω–∞** (–ø—Ä–æ–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–æ—Ç —à–∞–≥)
7. –ù–∞–∂–º–∏—Ç–µ `DONE`

#### 3.2 –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–∞ –¥–æ—Å—Ç—É–ø–∞

1. –ù–∞–π–¥–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π Service Account –≤ —Å–ø–∏—Å–∫–µ
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–µ–≥–æ ‚Üí –≤–∫–ª–∞–¥–∫–∞ `KEYS`
3. –ù–∞–∂–º–∏—Ç–µ `ADD KEY` ‚Üí `Create new key`
4. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø `JSON`
5. –°–∫–∞—á–∞–µ—Ç—Å—è —Ñ–∞–π–ª `your-project-xxxxx.json`

#### 3.3 –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ credentials

–û—Ç–∫—Ä–æ–π—Ç–µ —Å–∫–∞—á–∞–Ω–Ω—ã–π JSON —Ñ–∞–π–ª. –ù–∞–π–¥–∏—Ç–µ –¥–≤–∞ –ø–æ–ª—è:

```json
{
  "client_email": "wu-coach-crm-import@your-project.iam.gserviceaccount.com",
  "private_key": "-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgk...\n-----END PRIVATE KEY-----\n"
}
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ:
- `client_email` ‚Üí `GOOGLE_SERVICE_ACCOUNT_EMAIL` –≤ .env
- `private_key` ‚Üí `GOOGLE_PRIVATE_KEY` –≤ .env

#### 3.4 –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ Google Sheets

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à—É —Ç–∞–±–ª–∏—Ü—É Google Sheets
2. –ù–∞–∂–º–∏—Ç–µ `Share` (–ü–æ–¥–µ–ª–∏—Ç—å—Å—è)
3. –í—Å—Ç–∞–≤—å—Ç–µ email service account: `wu-coach-crm-import@your-project.iam.gserviceaccount.com`
4. –ü—Ä–∞–≤–∞: **Viewer** (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è —á—Ç–µ–Ω–∏—è)
5. –ù–∞–∂–º–∏—Ç–µ `Send`

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Google Sheets

### –¢—Ä–µ–±—É–µ–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏

–°–∫—Ä–∏–ø—Ç –æ–∂–∏–¥–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏ –≤ –ø–µ—Ä–≤–æ–º –ª–∏—Å—Ç–µ —Ç–∞–±–ª–∏—Ü—ã:

| –ö–æ–ª–æ–Ω–∫–∞ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------------|----------|
| `–§–ò–û` | ‚úÖ –î–∞ | –ü–æ–ª–Ω–æ–µ –∏–º—è –∫–ª–∏–µ–Ω—Ç–∞ (–§–∞–º–∏–ª–∏—è –ò–º—è –û—Ç—á–µ—Å—Ç–≤–æ) |
| `–ì—Ä—É–ø–ø–∞` | ‚ùå –ù–µ—Ç | –ì—Ä—É–ø–ø–∞: –ù–∞—á–∏–Ω–∞—é—â–∏–µ, –°—Ä–µ–¥–Ω—è—è, –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è, –≠–ª–∏—Ç–Ω–∞—è |
| `–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞` | ‚ùå –ù–µ—Ç | –î–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYY-MM-DD –∏–ª–∏ DD.MM.YYYY |
| `–¢–µ–ª–µ—Ñ–æ–Ω` | ‚ùå –ù–µ—Ç | –¢–µ–ª–µ—Ñ–æ–Ω –∫–ª–∏–µ–Ω—Ç–∞ |
| `Email` | ‚ùå –ù–µ—Ç | Email –∫–ª–∏–µ–Ω—Ç–∞ |

### –ü—Ä–∏–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã

| –§–ò–û | –ì—Ä—É–ø–ø–∞ | –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ | –¢–µ–ª–µ—Ñ–æ–Ω | Email |
|-----|--------|---------------------------|---------|-------|
| –ò–≤–∞–Ω–æ–≤ –ü–µ—Ç—Ä –°–µ—Ä–≥–µ–µ–≤–∏—á | –ù–∞—á–∏–Ω–∞—é—â–∏–µ | 2025-12-31 | +7 (999) 123-45-67 | ivanov@example.com |
| –°–∏–¥–æ—Ä–æ–≤ –ê–ª–µ–∫—Å–µ–π | –°—Ä–µ–¥–Ω—è—è | 2025-11-30 | +7 (999) 234-56-78 | sidorov@example.com |
| –ö–æ–∑–ª–æ–≤ –î–º–∏—Ç—Ä–∏–π | –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è | 2024-10-15 | +7 (999) 345-67-89 | kozlov@example.com |

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

- **–ê–∫—Ç–∏–≤–µ–Ω** (`active`): –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ >= —Å–µ–≥–æ–¥–Ω—è
- **–ù–µ–∞–∫—Ç–∏–≤–µ–Ω** (`inactive`): –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∞–±–æ–Ω–µ–º–µ–Ω—Ç–∞ < —Å–µ–≥–æ–¥–Ω—è –ò–õ–ò –Ω–µ —É–∫–∞–∑–∞–Ω–∞

---

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### ‚ö° –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø: GitHub Actions (–æ–±–ª–∞—á–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –≤ –æ–±–ª–∞–∫–µ GitHub (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Å–≤–æ–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞)
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —Ä–µ–ø–æ (2000 –º–∏–Ω—É—Ç/–º–µ—Å—è—Ü –¥–ª—è –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö)
- ‚úÖ –ó–∞–ø—É—Å–∫ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (–∫–∞–∂–¥—ã–µ 5-15 –º–∏–Ω—É—Ç)
- ‚úÖ –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –æ–¥–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π
- ‚úÖ –õ–æ–≥–∏ –≤—Å–µ—Ö –∑–∞–ø—É—Å–∫–æ–≤
- ‚úÖ Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞:**

1. **Workflow —É–∂–µ —Å–æ–∑–¥–∞–Ω!** –§–∞–π–ª: `.github/workflows/crm-sync.yml`

2. **–î–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ GitHub:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π ‚Üí Settings ‚Üí Secrets and variables ‚Üí Actions
   - –î–æ–±–∞–≤—å—Ç–µ 5 —Å–µ–∫—Ä–µ—Ç–æ–≤ (—Å–º. –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –Ω–∏–∂–µ)

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–µ—Ä–≤—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é:**
   - Actions ‚Üí CRM Sync ‚Üí Run workflow

**üìñ –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** –°–º. —Ñ–∞–π–ª `GITHUB_SECRETS_SETUP.md` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞

**–ß–∞—Å—Ç–æ—Ç–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç):**
```yaml
# –†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .github/workflows/crm-sync.yml, —Å—Ç—Ä–æ–∫–∞ 6:
- cron: '*/15 * * * *'  # –ö–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç
- cron: '*/5 * * * *'   # –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- cron: '*/30 * * * *'  # –ö–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç
```

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: Cron job (Linux/macOS)

–ó–∞–ø—É—Å–∫–∞—Ç—å –∫–∞–∂–¥—É—é –Ω–æ—á—å –≤ 3:00:

```bash
crontab -e
```

–î–æ–±–∞–≤–∏—Ç—å:

```cron
0 3 * * * cd /path/to/project/migration && node import-from-crm.js >> /var/log/crm-import.log 2>&1
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Actions

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π workflow, —Å–æ–∑–¥–∞–π—Ç–µ `.github/workflows/crm-import.yml`:

```yaml
name: CRM Import

on:
  schedule:
    - cron: '0 3 * * *'  # –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00 UTC
  workflow_dispatch:  # –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫

jobs:
  import:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'

      - name: Install dependencies
        run: |
          cd migration
          npm install

      - name: Run CRM import
        env:
          SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
          SUPABASE_SERVICE_KEY: ${{ secrets.SUPABASE_SERVICE_KEY }}
          GOOGLE_SHEETS_ID: ${{ secrets.GOOGLE_SHEETS_ID }}
          GOOGLE_SERVICE_ACCOUNT_EMAIL: ${{ secrets.GOOGLE_SERVICE_ACCOUNT_EMAIL }}
          GOOGLE_PRIVATE_KEY: ${{ secrets.GOOGLE_PRIVATE_KEY }}
        run: |
          cd migration
          node import-from-crm.js
```

–î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –≤ GitHub:
`Settings` ‚Üí `Secrets and variables` ‚Üí `Actions` ‚Üí `New repository secret`

### –í–∞—Ä–∏–∞–Ω—Ç 4: Google Apps Script

–ï—Å–ª–∏ –≤–∞—à–∞ CRM —É–∂–µ –≤ Google Sheets, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ç—Ä–∏–≥–≥–µ—Ä:

```javascript
// Google Apps Script (–≤ —Å–∞–º–æ–π —Ç–∞–±–ª–∏—Ü–µ: Extensions ‚Üí Apps Script)

function syncToSupabase() {
  const SUPABASE_URL = 'https://mjkssesvhowmncyctmvs.supabase.co';
  const SUPABASE_SERVICE_KEY = 'your_service_key_here';

  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Athletes');
  const data = sheet.getDataRange().getValues();

  // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
  for (let i = 1; i < data.length; i++) {
    const row = data[i];
    const fullName = row[0]; // –ö–æ–ª–æ–Ω–∫–∞ A: –§–ò–û
    const group = row[1];    // –ö–æ–ª–æ–Ω–∫–∞ B: –ì—Ä—É–ø–ø–∞
    const subscriptionEnd = row[2]; // –ö–æ–ª–æ–Ω–∫–∞ C: –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è

    if (!fullName) continue;

    const status = new Date(subscriptionEnd) >= new Date() ? 'active' : 'inactive';

    const athleteData = {
      name: fullName,
      group: group || '–ù–∞—á–∏–Ω–∞—é—â–∏–µ',
      status: status
    };

    // –í—ã–∑–æ–≤ Supabase Postgres function
    const url = `${SUPABASE_URL}/rest/v1/rpc/save_athlete_with_validation`;

    const options = {
      method: 'post',
      headers: {
        'Content-Type': 'application/json',
        'apikey': SUPABASE_SERVICE_KEY,
        'Authorization': `Bearer ${SUPABASE_SERVICE_KEY}`
      },
      payload: JSON.stringify({ p_athlete_data: athleteData })
    };

    try {
      UrlFetchApp.fetch(url, options);
      Logger.log(`‚úÖ ${fullName} synced`);
    } catch (error) {
      Logger.log(`‚ùå Error syncing ${fullName}: ${error}`);
    }
  }
}

// –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä: Edit ‚Üí Current project's triggers ‚Üí Add Trigger
// Function: syncToSupabase
// Event source: Time-driven
// Type: Day timer
// Time: 3am to 4am
```

---

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "SUPABASE_SERVICE_KEY not found"

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª `.env` —Å–æ–∑–¥–∞–Ω –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ.

### –û—à–∏–±–∫–∞: "Error: No key or keyFile set"

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç `GOOGLE_PRIVATE_KEY` –≤ `.env`:
- –î–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `"-----BEGIN PRIVATE KEY-----\n`
- –î–æ–ª–∂–µ–Ω –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è –Ω–∞ `\n-----END PRIVATE KEY-----\n"`
- –°–∏–º–≤–æ–ª—ã `\n` –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ `\\n` –≤ .env —Ñ–∞–π–ª–µ

### –û—à–∏–±–∫–∞: "Request had insufficient authentication scopes"

**–†–µ—à–µ–Ω–∏–µ**:
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Service Account –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ Google Sheets
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ —Ä–∞—Å—à–∞—Ä–µ–Ω–∞ –Ω–∞ email service account
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ scope –≤ –∫–æ–¥–µ: `https://www.googleapis.com/auth/spreadsheets.readonly`

### –û—à–∏–±–∫–∞: "Athlete name is required"

**–†–µ—à–µ–Ω–∏–µ**: –í Google Sheets –µ—Å—Ç—å –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏. –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –∏—Ö.

### –û—à–∏–±–∫–∞: "Invalid athlete group"

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏—è –≥—Ä—É–ø–ø –≤ Google Sheets. –î–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:
- –ù–∞—á–∏–Ω–∞—é—â–∏–µ
- –°—Ä–µ–¥–Ω—è—è
- –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è
- –≠–ª–∏—Ç–Ω–∞—è

–ï—Å–ª–∏ —É –≤–∞—Å –¥—Ä—É–≥–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è, –æ–±–Ω–æ–≤–∏—Ç–µ `GROUP_MAPPING` –≤ —Å–∫—Ä–∏–ø—Ç–µ.

---

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç –≤—ã–≤–æ–¥–∏—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏:

```
üöÄ –ó–∞–ø—É—Å–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏–∑ CRM...

‚úÖ Supabase client –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
‚úÖ Google Sheets client –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
üì• –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Google Sheets...
üìä –¢–∞–±–ª–∏—Ü–∞: WU Coach CRM
üìã –ù–∞–π–¥–µ–Ω–æ 156 –∑–∞–ø–∏—Å–µ–π –≤ CRM

‚úÖ –ò–≤–∞–Ω–æ–≤ –ü–µ—Ç—Ä –°–µ—Ä–≥–µ–µ–≤–∏—á ‚Üí active (–ù–∞—á–∏–Ω–∞—é—â–∏–µ)
‚úÖ –°–∏–¥–æ—Ä–æ–≤ –ê–ª–µ–∫—Å–µ–π ‚Üí active (–°—Ä–µ–¥–Ω—è—è)
‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—Ç—Ä–æ–∫–∏: Athlete name is required
‚úÖ –ö–æ–∑–ª–æ–≤ –î–º–∏—Ç—Ä–∏–π ‚Üí inactive (–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è)
...

==================================================
üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–ò
==================================================
‚úÖ –£—Å–ø–µ—à–Ω–æ: 154
‚ùå –û—à–∏–±–∫–∏: 2

‚ùå –î–µ—Ç–∞–ª–∏ –æ—à–∏–±–æ–∫:
  –°—Ç—Ä–æ–∫–∞ 12 (undefined): Athlete name is required
  –°—Ç—Ä–æ–∫–∞ 89 (–ò–≤–∞–Ω–æ–≤–∞ –ê–Ω–Ω–∞): Invalid athlete group: –ù–æ–≤–∏—á–∫–∏
==================================================
‚ö†Ô∏è –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —Å –æ—à–∏–±–∫–∞–º–∏
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. ‚úÖ **–ù–ï –∫–æ–º–º–∏—Ç–∏—Ç—å** —Ñ–∞–π–ª `.env` –≤ git (—É–∂–µ –≤ `.gitignore`)
2. ‚úÖ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å** GitHub Secrets –¥–ª—è CI/CD
3. ‚úÖ **–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å** –¥–æ—Å—Ç—É–ø Service Account —Ç–æ–ª—å–∫–æ –∫ –Ω—É–∂–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ
4. ‚úÖ **–•—Ä–∞–Ω–∏—Ç—å** Service Role Key –≤ —Å–µ–∫—Ä–µ—Ç–Ω–æ–º –º–µ—Å—Ç–µ
5. ‚úÖ **–†–æ—Ç–∏—Ä–æ–≤–∞—Ç—å** –∫–ª—é—á–∏ —Ä–∞–∑ –≤ 90 –¥–Ω–µ–π

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–¥–µ–ª "–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º"
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–∫—Ä–∏–ø—Ç–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –≤ Google Sheets

---

**–í–µ—Ä—Å–∏—è**: 1.0.0
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 2025-11-11
**–ê–≤—Ç–æ—Ä**: WU Coach Team
