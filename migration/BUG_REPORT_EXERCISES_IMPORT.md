# üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ exercises

**–î–∞—Ç–∞**: 2025-11-16
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

---

## –ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ

1. –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∏ exercises –∏–∑ Google Sheets –≤ Supabase
2. –°–∫—Ä–∏–ø—Ç `import-exercises-from-sheets.js` **–£–î–ê–õ–ò–õ –í–°–ï –°–£–©–ï–°–¢–í–£–Æ–©–ò–ï exercises**
3. CASCADE DELETE —Å—Ä–∞–±–æ—Ç–∞–ª ‚Üí **–í–°–ï performances –£–î–ê–õ–ï–ù–´**
4. –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Å–ø–æ—Ä—Ç—Å–º–µ–Ω–æ–≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ—Ç–µ—Ä—è–Ω—ã

---

## –ö–æ—Ä–µ–Ω—å –ø—Ä–æ–±–ª–µ–º—ã

```javascript
// import-exercises-from-sheets.js:178-186
const { error: deleteError } = await supabase
  .from('exercises')
  .delete()
  .neq('id', '00000000-0000-0000-0000-000000000000'); // DELETE ALL
```

**Foreign Key —Å CASCADE**:
```
performances.exercise_id ‚Üí exercises.id (ON DELETE CASCADE)
```

–£–¥–∞–ª–µ–Ω–∏–µ exercises –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª–∏–ª–æ –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ performances.

---

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

- ‚úÖ Exercises: 660 –∑–∞–ø–∏—Å–µ–π (–Ω–æ–≤—ã–µ UUID)
- ‚ùå Performances: 0 –∑–∞–ø–∏—Å–µ–π (–≤—Å–µ —É–¥–∞–ª–µ–Ω—ã)
- ‚ùå –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è (–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ–±–ª–µ–º–∞ —Å –Ω–æ–≤—ã–º–∏ exercise.id)

---

## –ü–ª–∞–Ω –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É performances
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å foreign key constraint
SELECT * FROM information_schema.table_constraints
WHERE table_name = 'performances';
```

### –®–∞–≥ 2: –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ exercise.name –≤ PWA –∏ Supabase
- –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ lookup –ø–æ –∏–º–µ–Ω–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –®–∞–≥ 3: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ
- **–ù–ò–ö–û–ì–î–ê –Ω–µ —É–¥–∞–ª—è—Ç—å exercises —Å CASCADE**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å UPSERT –≤–º–µ—Å—Ç–æ DELETE + INSERT
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∏–º–ø–æ—Ä—Ç–∞ (UPSERT)

```javascript
// –ü–†–ê–í–ò–õ–¨–ù–´–ô –ø–æ–¥—Ö–æ–¥ - UPSERT –ø–æ –∏–º–µ–Ω–∏
async function importExercises(exercises) {
  for (const ex of exercises) {
    await supabase
      .from('exercises')
      .upsert(
        { name: ex.name, score: ex.score, type: ex.type, category: ex.category },
        { onConflict: 'name' }
      );
  }
}
```

---

## –§–∞–π–ª—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

1. `migration/import-exercises-from-sheets.js` - –æ–ø–∞—Å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –Ω–∞ –ª–∏–Ω–∏–∏ 178-186
2. `supabase/migrations/20251110000000_initial_schema.sql` - foreign key constraints
3. `index.html` - –ª–æ–≥–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è performances (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å exercise.id lookup)

---

## –í–ê–ñ–ù–û

‚ö†Ô∏è **–î–ê–ù–ù–´–ï –ü–û–¢–ï–†–Ø–ù–´ –ù–ê–í–°–ï–ì–î–ê** –µ—Å–ª–∏ –Ω–µ—Ç –±—ç–∫–∞–ø–∞ –≤:
- localStorage –±—Ä–∞—É–∑–µ—Ä–∞
- Google Sheets
- Supabase Point-in-Time Recovery (Pro –ø–ª–∞–Ω)

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. [x] –î–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—á–µ–º—É performances –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
2. [x] –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –∏–º–ø–æ—Ä—Ç–∞ (UPSERT –≤–º–µ—Å—Ç–æ DELETE)
3. [x] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ø–µ—Ä–µ–¥ –æ–ø–∞—Å–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
4. [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã

---

## ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï (2025-11-16)

### –ü—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã
- PWA –∏—â–µ—Ç –±–∞–∑–æ–≤—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –ø–æ –∏–º–µ–Ω–∏: `exercisesData.find(e => e.name === '–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è')`
- –ò–º–ø–æ—Ä—Ç –∑–∞–º–µ–Ω–∏–ª –±–∞–∑–æ–≤—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –Ω–∞ 660 —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ Google Sheets
- –ë–∞–∑–æ–≤—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –Ω–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–∏ –≤ Supabase ‚Üí performances –Ω–µ –º–æ–≥–ª–∏ –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω—ã

### –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

1. **–î–æ–±–∞–≤–ª–µ–Ω—ã –±–∞–∑–æ–≤—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è** (`migration/add-base-exercises.js`):
   - ‚úÖ –ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è: `cf0d823f-2d9f-4aaf-a818-51f60a244b92`
   - ‚úÖ –û—Ç–∂–∏–º–∞–Ω–∏—è –æ—Ç –ø–æ–ª–∞: `84110bf3-6308-441f-b16a-6deaadf76223`
   - ‚úÖ –û—Ç–∂–∏–º–∞–Ω–∏—è –æ—Ç –±—Ä—É—Å—å–µ–≤: `e6643935-eef4-43bc-9c8a-dd49659d7600`

2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Å–∫—Ä–∏–ø—Ç –∏–º–ø–æ—Ä—Ç–∞** (`migration/import-exercises-from-sheets.js`):
   - ‚ùå –£–¥–∞–ª—ë–Ω –æ–ø–∞—Å–Ω—ã–π DELETE ALL (—Å—Ç—Ä–æ–∫–∏ 185-188)
   - ‚úÖ –ó–∞–º–µ–Ω—ë–Ω –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π UPSERT (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è ‚Üí –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ/–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ)
   - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
   - ‚úÖ –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ exercises –∏ –∏—Ö performances —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

3. **–°–æ–∑–¥–∞–Ω—ã –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã**:
   - `migration/check-exercises.js` - –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ exercises –≤ Supabase
   - `migration/add-base-exercises.js` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π

### –†–µ–∑—É–ª—å—Ç–∞—Ç
- ‚úÖ PWA —Ç–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å performances
- ‚úÖ –ë–∞–∑–æ–≤—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ Supabase
- ‚úÖ –°–∫—Ä–∏–ø—Ç –∏–º–ø–æ—Ä—Ç–∞ –±–µ–∑–æ–ø–∞—Å–µ–Ω (–Ω–µ —É–¥–∞–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ)
- ‚ö†Ô∏è  –°—Ç–∞—Ä—ã–µ performances –ø–æ—Ç–µ—Ä—è–Ω—ã –Ω–∞–≤—Å–µ–≥–¥–∞ (CASCADE DELETE —É–∂–µ –ø—Ä–æ–∏–∑–æ—à—ë–ª)

### –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è
- –°–∫—Ä–∏–ø—Ç –∏–º–ø–æ—Ä—Ç–∞ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç UPSERT –≤–º–µ—Å—Ç–æ DELETE ALL
- –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏-–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –≤ –∫–æ–¥–µ
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–µ–ª–∞—Ç—å –±—ç–∫–∞–ø—ã –ø–µ—Ä–µ–¥ –ª—é–±—ã–º–∏ –º–∞—Å—Å–æ–≤—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏

---

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π**: Claude Code
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: P0 - –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô (–ò–°–ü–†–ê–í–õ–ï–ù–û)
